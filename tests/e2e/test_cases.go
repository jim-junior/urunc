// Copyright (c) 2023-2026, Nubificus LTD
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package urunce2etesting

func nerdctlTestCases(kvmGroup ...int64) []containerTestArgs {
	var group int64
	if len(kvmGroup) > 0 {
		group = kvmGroup[0]
	}
	return []containerTestArgs{
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-hvt-rumprun:latest",
			Name:           "Hvt-rumprun-capture-hello",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Hello world",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-spt-rumprun:latest",
			Name:           "Spt-rumprun-capture-hello",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Hello world",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-hvt-rumprun-raw:latest",
			Name:           "Hvt-rumprun-ping-redis",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-hvt-rumprun-block:latest",
			Name:           "Hvt-rumprun-ping-redis-with-block",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-hvt-mirage:latest",
			Name:           "Hvt-mirage-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-hvt-rumprun-raw:latest",
			Name:           "Hvt-rumprun-with-seccomp",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-hvt-rumprun-raw:latest",
			Name:           "Hvt-rumprun-without-seccomp",
			Devmapper:      true,
			Seccomp:        false,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-hvt-rumprun-block:latest",
			Name:           "Hvt-rumprun-UserGroup",
			Devmapper:      false,
			Seccomp:        true,
			UID:            65534,
			GID:            65534,
			Groups:         []int64{group},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       userGroupTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-spt-rumprun-raw:latest",
			Name:           "Spt-rumprun-ping-redis",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-spt-mirage:latest",
			Name:           "Spt-mirage-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-spt-mirage:latest",
			Name:           "Spt-mirage-UserGroup",
			Devmapper:      false,
			Seccomp:        true,
			UID:            65534,
			GID:            65534,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       userGroupTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-ping-redis",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-qemu-mirage:latest",
			Name:           "Qemu-mirage-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-qemu-linux-raw:latest",
			Name:           "Qemu-linux-nginx",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-server-qemu-mewz:latest",
			Name:           "Qemu-mewz-hello-server",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-with-seccomp",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-without-seccomp",
			Devmapper:      false,
			Seccomp:        false,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-ping-nginx",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-linux-raw:latest",
			Name:           "Firecracker-linux-nginx",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-with-seccomp",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-without-seccomp",
			Devmapper:      false,
			Seccomp:        false,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-namespaces",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       namespaceTest,
		},
		{
			Image:     "harbor.nbfc.io/nubificus/urunc/busybox-qemu-linux-raw:latest",
			Name:      "Qemu-linux-block-mounts",
			Devmapper: true,
			Seccomp:   true,
			UID:       0,
			GID:       0,
			Groups:    []int64{},
			Memory:    "",
			Cli:       "/bin/cat /proc/self/mountinfo",
			Volumes: []containerVolume{
				{Source: "/tmp/test_mountpoint", Dest: "/mnt/data/mp"},
			},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "",
			TestFunc:       blockMountTest,
		},
		{
			Image:     "harbor.nbfc.io/nubificus/urunc/busybox-firecracker-linux-raw:latest",
			Name:      "Firecracker-linux-block-mounts",
			Devmapper: true,
			Seccomp:   true,
			UID:       0,
			GID:       0,
			Groups:    []int64{},
			Memory:    "",
			Cli:       "/bin/cat /proc/self/mountinfo",
			Volumes: []containerVolume{
				{Source: "/tmp/test_mountpoint", Dest: "/mnt/data/mp"},
			},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "",
			TestFunc:       blockMountTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/busybox-cloud-hypervisor-linux-raw:latest",
			Name:           "CloudHypervisor-linux-ping",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/busybox-cloud-hypervisor-linux-raw:latest",
			Name:           "CloudHypervisor-linux-seccomp",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "/bin/busybox tail -f /dev/null",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-cloud-hypervisor-linux-raw:latest",
			Name:           "CloudHypervisor-linux-nginx",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
	}
}

func ctrTestCases() []containerTestArgs {
	return []containerTestArgs{
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-hvt-rumprun-nonet:latest",
			Name:           "Hvt-rumprun-hello",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Hello world",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-hvt-mirage:latest",
			Name:           "Hvt-mirage-hello",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "--hello=holaHola",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "holaHola",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/block-test-hvt-mirage:latest",
			Name:           "Hvt-mirage-block-test",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Total tests passed:  10",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-spt-rumprun-nonet:latest",
			Name:           "Spt-rumprun-hello",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Hello world",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-spt-mirage:latest",
			Name:           "Spt-mirage-hello",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "--hello=Holahola",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Holahola",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/block-test-spt-mirage:latest",
			Name:           "Spt-mirage-block-test",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Total tests passed:  10",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-qemu-unikraft:latest",
			Name:           "Qemu-unikraft-hello",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "hello Unikraft Qemu urunc",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "\"Unikraft\" \"Qemu\" \"urunc\"",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-firecracker-unikraft:latest",
			Name:           "Firecracker-unikraft-hello",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "hello Unikraft FC urunc",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "\"Unikraft\" \"FC\" \"urunc\"",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-env-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-environment-variables",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "URUNC=urunc",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/readfile-qemu-unikraft-raw:latest",
			Name:           "Qemu-unikraft-read-file-9pfs",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Once upon a time",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-world-qemu-linux-initrd:latest",
			Name:           "Qemu-linux-hello-world",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "/urunit /clis Linux Qemu urunc",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Linux Qemu urunc",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/readfile-qemu-linux-raw:latest",
			Name:           "Qemu-linux-read-file-virtiofs",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Once upon a time",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-exec-env-qemu-linux-raw:latest",
			Name:           "Qemu-linux-environment-setup-create-initrd",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            17,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "UID: 0 GID: 17 WD: /test_dir URUNC: urunc",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-env-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-environment-variables",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "URUNC=urunc",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-world-firecracker-linux-initrd:latest",
			Name:           "Firecracker-linux-hello-world",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "/urunit /clis Linux FC urunc",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "Linux FC urunc",
			TestFunc:       matchTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-exec-env-firecracker-linux-initrd:latest",
			Name:           "Firecracker-linux-environment-setup-append-initrd",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            42,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			ExpectOut:      "UID: 0 GID: 42 WD: /test_dir URUNC: urunc",
			TestFunc:       matchTest,
		},
	}
}

func crictlTestCases(kvmGroup ...int64) []containerTestArgs {
	var group int64
	if len(kvmGroup) > 0 {
		group = kvmGroup[0]
	}
	return []containerTestArgs{
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-hvt-rumprun-raw:latest",
			Name:           "Hvt-rumprun-redis",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-hvt-mirage:latest",
			Name:           "Hvt-mirage-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-spt-rumprun-raw:latest",
			Name:           "Spt-rumprun-redis",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-spt-mirage:latest",
			Name:           "Spt-mirage-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-spt-mirage:latest",
			Name:           "Spt-mirage-UserGroup",
			Devmapper:      false,
			Seccomp:        true,
			UID:            65534,
			GID:            65534,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       userGroupTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-redis",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-qemu-mirage:latest",
			Name:           "Qemu-mirage-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-linux-block:latest",
			Name:           "Qemu-linux-redis",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-nginx",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-linux-raw:latest",
			Name:           "Firecracker-linux-nginx",
			Devmapper:      true,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/httpreply-firecracker-unikraft:latest",
			Name:           "Firecracker-unikraft-httpreply-static-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      true,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       httpStaticNetTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-namespaces",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       namespaceTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-UserGroup",
			Devmapper:      false,
			Seccomp:        true,
			UID:            65534,
			GID:            65534,
			Groups:         []int64{group},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       userGroupTest,
		},
	}
}

func dockerTestCases(kvmGroup ...int64) []containerTestArgs {
	var group int64
	if len(kvmGroup) > 0 {
		group = kvmGroup[0]
	}
	return []containerTestArgs{
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-spt-mirage:latest",
			Name:           "Spt-mirage-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-spt-mirage:latest",
			Name:           "Spt-mirage-UserGroup",
			Devmapper:      false,
			Seccomp:        true,
			UID:            65534,
			GID:            65534,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       userGroupTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-ping-redis",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-ping-nginx",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/net-qemu-mirage:latest",
			Name:           "Qemu-mirage-net",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/hello-server-qemu-mewz:latest",
			Name:           "Qemu-mewz-hello-server",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-linux-block:latest",
			Name:           "Qemu-linux-redis",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-with-seccomp",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-without-seccomp",
			Devmapper:      false,
			Seccomp:        false,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-qemu-unikraft-initrd:latest",
			Name:           "Qemu-unikraft-UserGroup",
			Devmapper:      false,
			Seccomp:        true,
			UID:            65534,
			GID:            65534,
			Groups:         []int64{group},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       userGroupTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-ping-nginx",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/redis-firecracker-linux-block:latest",
			Name:           "Firecracker-linux-redis",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "512M",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       pingTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-with-seccomp",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-without-seccomp",
			Devmapper:      false,
			Seccomp:        false,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       seccompTest,
		},
		{
			Image:          "harbor.nbfc.io/nubificus/urunc/nginx-firecracker-unikraft-initrd:latest",
			Name:           "Firecracker-unikraft-namespaces",
			Devmapper:      false,
			Seccomp:        true,
			UID:            0,
			GID:            0,
			Groups:         []int64{},
			Memory:         "",
			Cli:            "",
			Volumes:        []containerVolume{},
			StaticNet:      false,
			SideContainers: []string{},
			Skippable:      false,
			TestFunc:       namespaceTest,
		},
	}
}
